# Google Analytics integration plugin

This plugin adds Google Analytics tracking and reporting features to the [OctoberCMS](http://octobercms.com).

## Configuration

### Configure the API

Google Analytics API uses the OAuth security. In order to use the plugin you need create a Google API application.

1. Go to the [Google API Console](https://cloud.google.com/console/project), from the "Select a project" dropdown, select **Create a project**.

1. Enter a name for the project, eg: `OctoberCMS Analytics`, accept the terms and click **Create**. Wait a moment and you should be automatically sent to the project page.

1. From the "Use Google APIs" section, select **Enable and manage APIs** and then enable the **Analytics API** .

1. Select the **Credentials** section, click **New credentials** and create a **Service account key**.

1. Select **New service account** from the "Service account" dropdown, enter a name for this account, eg: `OctoberCMS Analytics`, and an ID will be generated for you.

1. Select **P12** as the "Key type" and click **Create**.

1. A `.p12` file will be generated, this is the private key for your account. Accept the download and save it to your computer. Click **Close**.

1. Click on **Manage service accounts**, select the **Permissions tab** and copy to your clipboard the email address ending with `@developer.gserviceaccount.com`.

1. Keep this tab open, the details from the **Permissions tab** will be used again below.

### Configure Google Analytics

1. In a new tab, navigate to the main [Google Analytics site](https://www.google.com/analytics/web/) and select the property you want to track.

1. Click the **Admin** main menu tab at the top. Select the **Property > User Management** menu item.

1. *Paste the email address from the clipboard* in to the field **Add permissions for** and make sure the permission is set to **Read & Analyse**. Click **Add**.

1. Click the **Admin** main menu tab again and select **Account > Account Settings** from the menu. *Copy to your clipboard* the Account ID (should be a number).

### Configure October back-end area

1. Open your October back-end administration area and open **Settings > Google Analytics**. 

1. *Paste the Account ID from the clipboard* in to the field **Analytics View/Profile ID number**.

1. Enter the name of the Google Developers Project in the **Google API project name** field, eg: `OctoberCMS Analytics`.

1. Enter the Service Account ID (ending with `.apps.googleusercontent.com`) in the **Google API Client ID** field. This should be sourced from the **Permissions tab** open in the other browser tab.

1. Enter the email address (ending with `@developer.gserviceaccount.com`) in the **Email address** field.

1. Upload the previously downloaded `.p12` private key file to the **Private key** field.

1. Specify the **Tracking ID** (eg `UA-12312312-3`) and **Domain name** values if you are going to use the plugin's built-in tracking component.

1. If Tracking not working, change **Domain name** values to `auto` (fix for newborn google analytics account).

## Adding the tracking code

Using the tracking code provided by the plugin is optional - the reporting part does not depend on whether you track your traffic with the built-in tracker or with a custom code generated by Google Analytics tools. 

To add the plugin's tracking code to your website just drop the Google Analytics Tracker component to your CMS layout and add this code to the layout code after the page tag:

```php
{% page %}
{% component 'googleTracker' %}
```
